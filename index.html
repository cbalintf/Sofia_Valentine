<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sofia ‚Äî Will You Be My Valentine?</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="wrap">
    <div class="card">
      <div class="hearts" aria-hidden="true">
        <span class="heart">‚ù§</span>
        <span class="heart">‚ù§</span>
        <span class="heart">‚ù§</span>
      </div>

      <h1>For Sofia</h1>
      <p class="lead">Sofia, you light up every day. I have something to ask you...</p>

      <div class="ask">
        <h2>Will you be my Valentine?</h2>
        <div class="choice" id="choice">
          <button id="yesBtn" class="btn">Yes üíñ</button>
          <button id="noBtn" class="btn btn-secondary">No</button>
        </div>
        <div id="answer" class="answer hidden" aria-live="polite">
          <p>I'll love you, cherish you, and make you smile ‚Äî every day.</p>
          <p class="signature">‚Äî Cole</p>
        </div>
      </div>

      <footer class="small">Made with ‚ù§Ô∏è</footer>
    </div>
  </main>

  <script>
    const yes = document.getElementById('yesBtn');
    const no = document.getElementById('noBtn');
    const answer = document.getElementById('answer');
    const choice = document.getElementById('choice');

    function spawnHearts(count = 20) {
      for (let i = 0; i < count; i++) {
        const h = document.createElement('div');
        h.className = 'float-heart';
        h.style.left = Math.random() * 90 + '%';
        h.style.animationDuration = 3 + Math.random() * 3 + 's';
        h.textContent = '‚ù§';
        document.body.appendChild(h);
        setTimeout(() => h.remove(), 6000);
      }
    }

    yes.addEventListener('click', () => {
      answer.classList.remove('hidden');
      yes.disabled = true;
      no.disabled = true;
      yes.textContent = 'You said Yes ‚ù§Ô∏è';
      spawnHearts(30);
    });

    // Move the No button away when approached
    function moveNoButton() {
      const rect = choice.getBoundingClientRect();
      const btnW = no.offsetWidth;
      const btnH = no.offsetHeight;
      const padding = 12;
      const maxX = rect.width - btnW - padding;
      const maxY = rect.height - btnH - padding;
      const x = Math.random() * Math.max(0, maxX) + padding / 2;
      const y = Math.random() * Math.max(0, maxY) + padding / 2;
      no.style.position = 'absolute';
      no.style.left = x + 'px';
      no.style.top = y + 'px';
    }

    // Prepare container and lock No button size so it doesn't collapse when positioned
    choice.style.position = 'relative';
    no.style.position = 'absolute';
    // freeze size to current rendered size
    function lockNoSize(){
      const w = no.offsetWidth;
      const h = no.offsetHeight;
      no.style.width = w + 'px';
      no.style.height = h + 'px';
      no.style.whiteSpace = 'nowrap';
    }
    lockNoSize();
    // ensure stacking so Yes stays on top
    yes.style.zIndex = 3;
    no.style.zIndex = 2;

    // place No initially to the right
    no.style.left = Math.max(8, choice.clientWidth - no.offsetWidth - 8) + 'px';
    no.style.top = '6px';

    no.addEventListener('mouseenter', moveNoButton);
    no.addEventListener('touchstart', (e) => {
      e.preventDefault();
      moveNoButton();
    });

    // Move when the mouse gets near, with smaller sensitivity to avoid constant jumping
    document.addEventListener('mousemove', (e) => {
      const nb = no.getBoundingClientRect();
      const dx = e.clientX - (nb.left + nb.width / 2);
      const dy = e.clientY - (nb.top + nb.height / 2);
      const dist = Math.hypot(dx, dy);
      if (dist < 90) moveNoButton();
    });
  </script>
</body>
</html>
